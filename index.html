<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Trang Ch·ªß - SmartTKB</title>
    <!-- Th∆∞ vi·ªán CSS/JS Online (CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <!-- Load File D√πng Chung -->
    <script type="text/babel" src="js/common.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        function DashboardPage() {
            const [stats, setStats] = React.useState({ t: 0, c: 0, s: 0, a: 0 });

            React.useEffect(() => {
                const load = async () => {
                    // G·ªçi song song c√°c API ƒë·ªÉ l·∫•y s·ªë li·ªáu th·ªëng k√™
                    const [t, c, s, a] = await Promise.all([
                        window.api.call("/teachers/"),
                        window.api.call("/classes/"),
                        window.api.call("/subjects/"),
                        window.api.call("/assignments/")
                    ]);
                    setStats({
                        t: t?.length || 0,
                        c: c?.length || 0,
                        s: s?.length || 0,
                        a: a?.length || 0
                    });
                };
                load();
            }, []);

            const Card = ({ title, val, color, icon }) => (
                <div className={`p-6 rounded-xl bg-white shadow-sm border-l-4 ${color} transform transition hover:scale-105`}>
                    <div className="flex justify-between items-center">
                        <div>
                            <h3 className="text-gray-500 text-xs font-bold uppercase tracking-wider">{title}</h3>
                            <p className="text-4xl font-bold text-gray-800 mt-2">{val}</p>
                        </div>
                        <div className="text-4xl opacity-20">{icon}</div>
                    </div>
                </div>
            );

            return (
                <window.AppLayout>
                    <div className="mb-8 flex justify-between items-end">
                        <div>
                            <h1 className="text-3xl font-bold text-gray-900">T·ªïng quan h·ªá th·ªëng</h1>
                            <p className="text-gray-500 mt-1">Xin ch√†o Qu·∫£n tr·ªã vi√™n, d∆∞·ªõi ƒë√¢y l√† t√¨nh h√¨nh d·ªØ li·ªáu hi·ªán t·∫°i.</p>
                        </div>
                        <div className="text-sm text-gray-400">
                            H√¥m nay: {new Date().toLocaleDateString('vi-VN')}
                        </div>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <Card title="Gi√°o vi√™n" val={stats.t} color="border-blue-500" icon="üë®‚Äçüè´" />
                        <Card title="L·ªõp h·ªçc" val={stats.c} color="border-green-500" icon="üè´" />
                        <Card title="M√¥n h·ªçc" val={stats.s} color="border-purple-500" icon="üìö" />
                        <Card title="Ph√¢n c√¥ng" val={stats.a} color="border-orange-500" icon="üìÖ" />
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div className="bg-white p-6 rounded-xl shadow-sm border">
                            <h3 className="font-bold text-lg mb-4 text-blue-800">üöÄ B·∫Øt ƒë·∫ßu nhanh</h3>
                            <ul className="space-y-3">
                                <li className="flex items-center gap-3 text-gray-700">
                                    <span className="bg-blue-100 text-blue-800 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold">1</span>
                                    <span>Nh·∫≠p danh s√°ch <b>Gi√°o vi√™n</b> v√† <b>L·ªõp h·ªçc</b>.</span>
                                </li>
                                <li className="flex items-center gap-3 text-gray-700">
                                    <span className="bg-blue-100 text-blue-800 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold">2</span>
                                    <span>Khai b√°o <b>M√¥n h·ªçc</b> trong ch∆∞∆°ng tr√¨nh.</span>
                                </li>
                                <li className="flex items-center gap-3 text-gray-700">
                                    <span className="bg-blue-100 text-blue-800 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold">3</span>
                                    <span>Th·ª±c hi·ªán <b>Ph√¢n c√¥ng chuy√™n m√¥n</b> (Ai d·∫°y l·ªõp n√†o).</span>
                                </li>
                                <li className="flex items-center gap-3 text-gray-700">
                                    <span className="bg-blue-100 text-blue-800 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold">4</span>
                                    <span>V√†o m·ª•c <b>X·∫øp TKB</b> ƒë·ªÉ ch·∫°y thu·∫≠t to√°n t·ª± ƒë·ªông.</span>
                                </li>
                            </ul>
                        </div>

                        <div className="bg-blue-50 p-6 rounded-xl border border-blue-100">
                            <h3 className="font-bold text-lg mb-4 text-blue-800">‚ÑπÔ∏è Tr·∫°ng th√°i h·ªá th·ªëng</h3>
                            <div className="space-y-2 text-sm">
                                <div className="flex justify-between">
                                    <span className="text-gray-600">Backend URL:</span>
                                    <span className="font-mono text-blue-600 truncate max-w-[200px]">{window.api.getUrl()}</span>
                                </div>
                                <div className="flex justify-between">
                                    <span className="text-gray-600">Tr·∫°ng th√°i API:</span>
                                    <span className="text-green-600 font-bold">‚óè ƒêang ho·∫°t ƒë·ªông</span>
                                </div>
                                <div className="mt-4 pt-4 border-t border-blue-200 text-xs text-gray-500">
                                    Phi√™n b·∫£n frontend: <b>v1.2 (Multi-page)</b>
                                </div>
                            </div>
                        </div>
                    </div>
                </window.AppLayout>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<DashboardPage />);
    </script>
</body>
</html>
